---
name: calendar
description: Create study sessions, revision blocks, and exam reminder events in Google Calendar. Accepts AI-generated revision schedules and creates individual calendar events with proper titles, times, and descriptions.
command: /calendar
inputs:
  - schedule[] (from AI-generated revision plan)
  - subject_name
outputs:
  - created_events[]
  - calendar_name
  - event_count
---

# Google Calendar — Study Scheduling

## Overview

Creates study and revision events in Google Calendar.

- Accepts a revision schedule generated by AI (dates, times, topics, durations)
- Creates individual calendar events for each session
- Adds descriptive titles, topic details, and reminders
- Supports color coding by event type
- Returns structured metadata of all created events

---

## Preconditions

- User logged into Google account in the browser
- Google Calendar accessible at calendar.google.com
- Revision schedule provided (from StudyEngine's AI revision planner)

---

## Inputs

- schedule[] (required): array of event objects, each containing:
    - title (required): event title (e.g., "Review #1: OS - Process Management")
    - date (required): event date (YYYY-MM-DD format)
    - start_time (required): start time (HH:MM, 24h format)
    - duration_minutes (default: 60): how long the session is
    - description (optional): topics to review, notes, or notebook link
    - event_type (optional): "review" | "practice_test" | "exam" | "study_session"
- subject_name (required): the overall subject (e.g., "Operating Systems")

---

## Execution Flow

### STEP 1 — Open Google Calendar

- Navigate to https://calendar.google.com
- Wait for page to fully load
- Confirm user is logged in (profile avatar visible)
- Confirm calendar grid is visible

Store:
calendar_name = primary calendar name (usually user's name or email)

---

### STEP 2 — Navigate to First Event Date

- Switch to the appropriate calendar view:
    - If all events are within 1 week → use Week view
    - If events span multiple weeks → use Month view
- Navigate to the date of the first event in schedule[]

---

### STEP 3 — Create Events

For each event in schedule[]:

    1. Navigate to the event's date if not already visible

    2. Click on the target time slot on the calendar grid
       OR click the "+" / "Create" button

    3. In the event creation dialog/form:

        a. TITLE:
           - Enter the event title
           - Format: "{title}" as provided in schedule
           - Example: "Review #1: OS - Process Management"

        b. DATE & TIME:
           - Set date to event.date
           - Set start time to event.start_time
           - Set end time to start_time + duration_minutes
           - If duration_minutes not provided, default to 60 minutes

        c. DESCRIPTION (if provided):
           - Click "Add description" or "More details"
           - Enter the description text
           - Include topics to review
           - Include notebook link if provided

        d. REMINDER:
           - Set notification to 30 minutes before (default)
           - For exam events: add a second reminder at 1 day before

        e. COLOR (optional, based on event_type):
           - "review" → Sage (green)
           - "practice_test" → Blueberry (blue)
           - "exam" → Tomato (red)
           - "study_session" → Lavender (purple)
           - If no event_type → use default calendar color

    4. Click "Save"

    5. Confirm event appears on the calendar grid

    6. Store in created_events[]:
        - title
        - date
        - start_time
        - duration_minutes
        - status: "created" | "failed"

    If event creation fails:
    - Retry once
    - If still failing → mark status as "failed" and continue

---

### STEP 4 — Event Verification

After all events are created:

- Scan the calendar for the date range of the schedule
- Count visible events matching the created titles
- Compare with expected event_count

If event_count < expected:
- Identify which events failed
- Report failed events to user

Store:
event_count = number of successfully created events

---

## Structured Output (CRITICAL)

Return:

{
  calendar_name: "Primary",
  subject_name: "Operating Systems",
  event_count: 5,
  created_events: [
      {
          title: "Review #1: OS - Process Management",
          date: "2026-02-20",
          start_time: "14:00",
          duration_minutes: 60,
          status: "created"
      },
      {
          title: "Review #2: OS - Memory Management",
          date: "2026-02-22",
          start_time: "14:00",
          duration_minutes: 60,
          status: "created"
      },
      {
          title: "Review #3: OS - File Systems",
          date: "2026-02-26",
          start_time: "14:00",
          duration_minutes: 90,
          status: "created"
      },
      {
          title: "Practice Test: OS Full Syllabus",
          date: "2026-03-05",
          start_time: "10:00",
          duration_minutes: 120,
          status: "created"
      },
      {
          title: "EXAM: Operating Systems",
          date: "2026-03-12",
          start_time: "09:00",
          duration_minutes: 180,
          status: "created"
      }
  ]
}

---

## Edge Case Handling

- If a time slot conflicts with an existing event:
  Create the event anyway (Google Calendar allows overlapping events).
  Note the conflict in the description: "⚠ Conflicts with: {existing event title}".

- If the date is in the past:
  Still create the event (user may be backdating). But warn in output.

- If Google Calendar shows a different timezone:
  Note the timezone in output. Times are created in the calendar's displayed timezone.

- If event creation dialog changes layout (compact vs full editor):
  If compact quick-add appears, click "More options" to get the full editor for description and color.

- If the schedule has > 20 events:
  Process in batches of 10. Verify each batch before proceeding.

---

## Downstream Skill Compatibility

This skill guarantees:
- All events have confirmed creation status
- Dates and times match the provided schedule
- Event count verified
- Clean structured JSON output

This is typically the final skill in a revision workflow chain.

---

## Examples

"Schedule revision sessions for my OS exam"
"Create a study plan for DBMS over the next 2 weeks"
"Add 5 review sessions and an exam reminder to my calendar"
"Schedule spaced repetition events for Computer Networks"
